(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{329:function(s,n,a){"use strict";a.r(n);var t=a(7),e=Object(t.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"binlog常用操作命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#binlog常用操作命令"}},[s._v("#")]),s._v(" binlog常用操作命令")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否启用binlog日志")]),s._v("\nshow variables like "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'log_bin'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看详细的日志配置信息")]),s._v("\nshow global variables like "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%log%'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysql数据存储目录")]),s._v("\nshow variables like "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%dir%'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看binlog的目录")]),s._v("\nshow global variables like "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%log_bin%"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看当前服务器使用的biglog文件及大小")]),s._v("\nshow binary logs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看主服务器使用的biglog文件及大小")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看最新一个binlog日志文件名称和Position")]),s._v("\nshow master status"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 事件查询命令")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# IN 'log_name' ：指定要查询的binlog文件名(不指定就是第一个binlog文件)")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# FROM pos ：指定从哪个pos起始点开始查起(不指定就是从整个文件首个pos点开始算)")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# LIMIT [offset,] ：偏移量(不指定就是0)")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# row_count ：查询总条数(不指定就是所有行)")]),s._v("\nshow binlog events "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("IN "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'log_name'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("FROM pos"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("LIMIT "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("offset,"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" row_count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看 binlog 内容")]),s._v("\nshow binlog events"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看具体一个binlog文件的内容 （in 后面为binlog的文件名）")]),s._v("\nshow binlog events "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'master.000003'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置binlog文件保存事件，过期删除，单位天")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" global "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("expire_log_days")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除当前的binlog文件")]),s._v("\nreset master"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除slave的中继日志")]),s._v("\nreset slave"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除指定日期前的日志索引中binlog日志文件")]),s._v("\npurge master logs before "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2019-03-09 14:00:00'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除指定日志文件")]),s._v("\npurge master logs to "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'master.000003’;\n# 设置binlog文件最大大小\nSET @@global.max_binlog_size = 4096;\n# 查询binlog文件最大大小\nSELECT @@global.max_binlog_size;\n# 查询binlog日志中是否包含SQL参数\nshow variables like '")]),s._v("binlog_rows_query_log_events'"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置binlog日志文件中包含SQL， 1 : 包含 ; 0 : 不包含")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" global "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("binlog_rows_query_log_events")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br")])]),n("h2",{attrs:{id:"配置文件信息"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置文件信息"}},[s._v("#")]),s._v(" 配置文件信息")]),s._v(" "),n("div",{staticClass:"language-properties line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-properties"}},[n("code",[s._v("[mysqld]\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# binlog相关配置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定binlog日志存储的位置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("datadir")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("/home/mysql/mysql/var")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 规范binlog的命名为 mysql-bin.0000XX")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 【开启binlog】加这行配置，binlog文件名为主机名")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("log-bin")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("mysql-bin")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 索引当前所有的binlog")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("log-bin-index")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("mysql-bin.index")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 最大的大小")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("max_binlog_size")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("1G")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# binlog的sync时机")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("sync-binlog")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("1")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# binlog的格式")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("binlog-format")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("ROW")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 保留七天的binlog")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("expire_logs_days")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("7")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br")])])])}),[],!1,null,null,null);n.default=e.exports}}]);